{
	"info": {
		"_postman_id": "cunapay-admin-001",
		"name": "CunaPay API - Administradores",
		"description": "Colección completa de endpoints para administradores de CunaPay",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Autenticación",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.token) {",
									"        pm.collectionVariables.set(\"token\", jsonData.token);",
									"        console.log(\"Token guardado automáticamente\");",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"admin@gmail.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["auth", "login"]
						},
						"description": "Autentica un administrador y devuelve un token JWT. El token se guarda automáticamente."
					}
				},
				{
					"name": "Cambiar Contraseña",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"currentPassword\": \"password123\",\n  \"newPassword\": \"newPassword456\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/change-password",
							"host": ["{{baseUrl}}"],
							"path": ["auth", "change-password"]
						},
						"description": "Cambia la contraseña del usuario autenticado"
					}
				}
			]
		},
		{
			"name": "Usuarios",
			"item": [
				{
					"name": "Listar Usuarios",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users?page=1&pageSize=20&search=&role=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users"],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "20"
								},
								{
									"key": "search",
									"value": "",
									"disabled": true
								},
								{
									"key": "role",
									"value": "",
									"disabled": true
								}
							]
						},
						"description": "Obtiene todos los usuarios con paginación y filtros"
					}
				},
				{
					"name": "Buscar Usuarios",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/search?q=usuario@example.com&limit=50",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "search"],
							"query": [
								{
									"key": "q",
									"value": "usuario@example.com"
								},
								{
									"key": "limit",
									"value": "50"
								}
							]
						},
						"description": "Busca usuarios por email (búsqueda rápida)"
					}
				},
				{
					"name": "Obtener Usuario por ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/:id",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Obtiene un usuario específico con todos sus datos, incluyendo wallet, balance y estadísticas"
					}
				},
				{
					"name": "Estadísticas de Usuarios",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "stats"]
						},
						"description": "Obtiene estadísticas generales de usuarios (total, admins, usuarios normales)"
					}
				},
				{
					"name": "Transacciones de Usuario (DB)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/:id/transactions?source=db&limit=10&status=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", ":id", "transactions"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							],
							"query": [
								{
									"key": "source",
									"value": "db"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "status",
									"value": "",
									"disabled": true
								}
							]
						},
						"description": "Obtiene todas las transacciones de base de datos de un usuario específico"
					}
				},
				{
					"name": "Transacciones de Usuario (On Chain)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/:id/transactions?source=onchain&limit=10&direction=&fingerprint=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", ":id", "transactions"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							],
							"query": [
								{
									"key": "source",
									"value": "onchain"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "direction",
									"value": "",
									"disabled": true
								},
								{
									"key": "fingerprint",
									"value": "",
									"disabled": true
								}
							]
						},
						"description": "Obtiene todas las transacciones on-chain de un usuario específico"
					}
				}
			]
		},
		{
			"name": "Admin Wallet",
			"item": [
				{
					"name": "Obtener Wallet del Admin",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/me/wallet",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "me", "wallet"]
						},
						"description": "Obtiene la wallet del admin actual"
					}
				},
				{
					"name": "Obtener Balance del Admin",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/me/balance",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "me", "balance"]
						},
						"description": "Obtiene el balance del admin actual (solo TRX y USDT, sin staking)"
					}
				},
				{
					"name": "Transacciones del Admin (DB)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/me/transactions?source=db&limit=10&status=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "me", "transactions"],
							"query": [
								{
									"key": "source",
									"value": "db"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "status",
									"value": "",
									"disabled": true
								}
							]
						},
						"description": "Obtiene todas las transacciones de base de datos del admin actual"
					}
				},
				{
					"name": "Transacciones del Admin (On Chain)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/me/transactions?source=onchain&limit=10&direction=&fingerprint=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "me", "transactions"],
							"query": [
								{
									"key": "source",
									"value": "onchain"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "direction",
									"value": "",
									"disabled": true
								},
								{
									"key": "fingerprint",
									"value": "",
									"disabled": true
								}
							]
						},
						"description": "Obtiene todas las transacciones on-chain del admin actual"
					}
				},
				{
					"name": "Enviar Transacción desde Admin",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"to\": \"TXYZopYRdj2D9XRtbG411XZZ3kM5VkAeBf\",\n  \"amount\": \"100.5\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/me/send",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "users", "me", "send"]
						},
						"description": "Envía USDT desde la wallet del admin a otra dirección"
					}
				}
			]
		},
		{
			"name": "Compras",
			"item": [
				{
					"name": "Listar Todas las Compras",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/purchases?status=&limit=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "purchases"],
							"query": [
								{
									"key": "status",
									"value": "",
									"disabled": true,
									"description": "Filtrar por estado: pending, accepted, rejected"
								},
								{
									"key": "limit",
									"value": "",
									"disabled": true,
									"description": "Límite de resultados"
								}
							]
						},
						"description": "Obtiene todas las solicitudes de compra (para admin)"
					}
				},
				{
					"name": "Obtener Compra Específica",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/purchases/:id",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "purchases", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Obtiene una compra específica (para admin)"
					}
				},
				{
					"name": "Aprobar Compra",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"notes\": \"Compra aprobada correctamente\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/purchases/:id/approve",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "purchases", ":id", "approve"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Aprueba una compra y deposita USDT al usuario desde la wallet del admin"
					}
				},
				{
					"name": "Rechazar Compra",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reason\": \"Comprobante de pago inválido\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/purchases/:id/reject",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "purchases", ":id", "reject"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Rechaza una compra"
					}
				},
				{
					"name": "Estadísticas de Compras",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/purchases/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "purchases", "stats"]
						},
						"description": "Obtiene estadísticas de compras (total, pending, accepted, rejected, totalUsdt, totalBs)"
					}
				}
			]
		},
		{
			"name": "Retiros",
			"item": [
				{
					"name": "Listar Todos los Retiros",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/withdrawals?status=&limit=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "withdrawals"],
							"query": [
								{
									"key": "status",
									"value": "",
									"disabled": true,
									"description": "Filtrar por estado: pending, completed, rejected"
								},
								{
									"key": "limit",
									"value": "",
									"disabled": true,
									"description": "Límite de resultados"
								}
							]
						},
						"description": "Obtiene todas las solicitudes de retiro (para admin)"
					}
				},
				{
					"name": "Obtener Retiro Específico",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/withdrawals/:id",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "withdrawals", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Obtiene un retiro específico (para admin)"
					}
				},
				{
					"name": "Aprobar Retiro",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"notes\": \"Retiro aprobado correctamente\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/withdrawals/:id/approve",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "withdrawals", ":id", "approve"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Aprueba un retiro y transfiere USDT del usuario al admin"
					}
				},
				{
					"name": "Rechazar Retiro",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reason\": \"Información bancaria incorrecta\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/withdrawals/:id/reject",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "withdrawals", ":id", "reject"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Rechaza un retiro"
					}
				},
				{
					"name": "Estadísticas de Retiros",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/withdrawals/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "admin", "withdrawals", "stats"]
						},
						"description": "Obtiene estadísticas de retiros (total, pending, completed, rejected, totalUsdt, totalBs)"
					}
				}
			]
		},
		{
			"name": "Noticias",
			"item": [
				{
					"name": "Listar Noticias",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/news?limit=&category=",
							"host": ["{{baseUrl}}"],
							"path": ["api", "news"],
							"query": [
								{
									"key": "limit",
									"value": "",
									"disabled": true,
									"description": "Límite de resultados"
								},
								{
									"key": "category",
									"value": "",
									"disabled": true,
									"description": "Filtrar por categoría"
								}
							]
						},
						"description": "Obtiene todas las noticias con filtros opcionales"
					}
				},
				{
					"name": "Crear Noticia",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Nueva noticia económica\",\n  \"category\": \"economia\",\n  \"link\": \"https://example.com/noticia\",\n  \"economicImpact\": \"positive\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/news",
							"host": ["{{baseUrl}}"],
							"path": ["api", "news"]
						},
						"description": "Crea una nueva noticia (Solo Admin)"
					}
				},
				{
					"name": "Actualizar Noticia",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Noticia actualizada\",\n  \"category\": \"economia\",\n  \"link\": \"https://example.com/noticia-actualizada\",\n  \"economicImpact\": \"negative\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/news/:id",
							"host": ["{{baseUrl}}"],
							"path": ["api", "news", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Actualiza una noticia (Solo Admin)"
					}
				},
				{
					"name": "Eliminar Noticia",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/news/:id",
							"host": ["{{baseUrl}}"],
							"path": ["api", "news", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "507f1f77bcf86cd799439011"
								}
							]
						},
						"description": "Elimina una noticia (Solo Admin)"
					}
				},
				{
					"name": "Listar Categorías",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/news/categories",
							"host": ["{{baseUrl}}"],
							"path": ["api", "news", "categories"]
						},
						"description": "Obtiene todas las categorías disponibles"
					}
				}
			]
		},
		{
			"name": "Binance P2P",
			"item": [
				{
					"name": "Precio Promedio Compra USDT",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/p2p/usdt/buy/avg?asset=USDT&fiat=BOB&rows=10",
							"host": ["{{baseUrl}}"],
							"path": ["api", "p2p", "usdt", "buy", "avg"],
							"query": [
								{
									"key": "asset",
									"value": "USDT"
								},
								{
									"key": "fiat",
									"value": "BOB"
								},
								{
									"key": "rows",
									"value": "10"
								}
							]
						},
						"description": "Obtiene el precio promedio de compra de USDT en Binance P2P (últimos 10 precios)"
					}
				},
				{
					"name": "Precio Promedio Venta USDT",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/p2p/usdt/sell/avg?asset=USDT&fiat=BOB&rows=10",
							"host": ["{{baseUrl}}"],
							"path": ["api", "p2p", "usdt", "sell", "avg"],
							"query": [
								{
									"key": "asset",
									"value": "USDT"
								},
								{
									"key": "fiat",
									"value": "BOB"
								},
								{
									"key": "rows",
									"value": "10"
								}
							]
						},
						"description": "Obtiene el precio promedio de venta de USDT en Binance P2P (últimos 10 precios)"
					}
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "https://cunapay-api.onrender.com",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		}
	]
}
